{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/musta/Documents/GitHub/guest_posting/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/musta/Documents/GitHub/guest_posting/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/musta/Documents/GitHub/guest_posting/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from\"react\";import Edit from\"../img/edit.png\";import Delete from\"../img/delete.png\";import{Link,useLocation,useNavigate}from\"react-router-dom\";import Menu from\"../components/Menu\";import axios from\"axios\";import moment from\"moment\";import{useContext}from\"react\";import{AuthContext}from\"../context/authContext\";import DOMPurify from\"dompurify\";import Comments from\"./comments\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Single=function Single(){var _useState=useState({}),_useState2=_slicedToArray(_useState,2),post=_useState2[0],setPost=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),post_likes=_useState4[0],setPostLikes=_useState4[1];var location=useLocation();var navigate=useNavigate();var postId=location.pathname.split(\"/\")[2];// console.log(location.pathname.split(\"/\"))\nvar _useContext=useContext(AuthContext),currentUser=_useContext.currentUser;var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),report_status=_useState6[0],set_report_status=_useState6[1];useEffect(function(){var fetchData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var res;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios.get(\"/posts/\".concat(postId));case 3:res=_context.sent;// console.log(res.data)\n// console.log(\"POST ID : \", postId)\n// console.log(\"in fetch data\")\nsetPostLikes(res.data.totalLikes);setPost(res.data);// console.log(\"YOUR TOTAL LIKES : \",post_likes)\n_context.next=11;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 11:case\"end\":return _context.stop();}}},_callee,null,[[0,8]]);}));return function fetchData(){return _ref.apply(this,arguments);};}();fetchData();// console.log(\"yess!!!!!!!!!!!!\")\n},[post]);// READER FUNCTIONALITY : \nvar Like=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(post){var post_array,res;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;// post.totalLikes = post.totalLikes + 1\npost_array=[post,currentUser];_context2.next=4;return axios.post(\"/posts/update_like\",post_array);case 4:res=_context2.sent;_context2.next=10;break;case 7:_context2.prev=7;_context2.t0=_context2[\"catch\"](0);console.log(\"err : \",_context2.t0);case 10:case\"end\":return _context2.stop();}}},_callee2,null,[[0,7]]);}));return function Like(_x){return _ref2.apply(this,arguments);};}();var Dis_Like=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(post){var post_array,res;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;// post.totalDislikes = post.totalDislikes + 1\npost_array=[post,currentUser];_context3.next=4;return axios.post(\"/posts/update_dislike\",post_array);case 4:res=_context3.sent;_context3.next=10;break;case 7:_context3.prev=7;_context3.t0=_context3[\"catch\"](0);console.log(\"err : \",_context3.t0);case 10:case\"end\":return _context3.stop();}}},_callee3,null,[[0,7]]);}));return function Dis_Like(_x2){return _ref3.apply(this,arguments);};}();var report_handler=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(post){var post_array,res;return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.prev=0;// post.totalLikes = post.totalLikes + 1\npost_array=[post,currentUser];_context4.next=4;return axios.post(\"/posts/update_report_status\",post_array);case 4:res=_context4.sent;set_report_status(res.data.message);console.log(post);_context4.next=12;break;case 9:_context4.prev=9;_context4.t0=_context4[\"catch\"](0);console.log(_context4.t0);// set_report_status(err.response.data)\ncase 12:case\"end\":return _context4.stop();}}},_callee4,null,[[0,9]]);}));return function report_handler(_x3){return _ref4.apply(this,arguments);};}();var deletepostid=postId;var usersname=currentUser.username;var handleDelete=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5(post){var array;return _regeneratorRuntime().wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.prev=0;array=[deletepostid,usersname];console.log(\"This is the stuff deleting:\",array);_context5.next=5;return axios.post(\"/posts/\".concat(postId),array);case 5:navigate(\"/\");_context5.next=12;break;case 8:_context5.prev=8;_context5.t0=_context5[\"catch\"](0);console.log(\"Throwing error\");console.log(_context5.t0);case 12:case\"end\":return _context5.stop();}}},_callee5,null,[[0,8]]);}));return function handleDelete(_x4){return _ref5.apply(this,arguments);};}();var getText=function getText(html){var doc=new DOMParser().parseFromString(html,\"text/html\");return doc.body.textContent;};return/*#__PURE__*/_jsx(\"div\",{className:\"single\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"user\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"repo\"}),/*#__PURE__*/_jsx(\"div\",{className:\"userSingle\",children:/*#__PURE__*/_jsx(\"span\",{children:post.writer_id})})]}),/*#__PURE__*/_jsx(\"p\",{className:\"postContent\",dangerouslySetInnerHTML:{__html:DOMPurify.sanitize(post.post_content)}}),/*#__PURE__*/_jsxs(\"h1\",{className:\"tagsSingle\",children:[post.tag1,\"   \",post.tag2,\"   \",post.tag3]}),/*#__PURE__*/_jsxs(\"div\",{className:\"buttonsSingle\",children:[/*#__PURE__*/_jsxs(\"button\",{className:\"button\",onClick:function onClick(){return Like(post);},children:[\" \\uD83D\\uDC4DUpVote : \",post.totalLikes]}),/*#__PURE__*/_jsxs(\"button\",{className:\"button\",onClick:function onClick(){return Dis_Like(post);},children:[\"\\uD83D\\uDC4EDownVote : \",post.totalDislikes]}),/*#__PURE__*/_jsxs(\"button\",{className:\"button\",onClick:function onClick(){return report_handler(post);},children:[\" \\uD83D\\uDEA9Reports:\",post.reportCount,/*#__PURE__*/_jsx(\"strong\",{children:report_status}),\" \"]}),/*#__PURE__*/_jsx(\"button\",{className:\"button\",onClick:function onClick(){return handleDelete(post);},children:\"Delete\"})]}),Comments(postId)]})});};export default Single;","map":{"version":3,"names":["React","useEffect","useState","Edit","Delete","Link","useLocation","useNavigate","Menu","axios","moment","useContext","AuthContext","DOMPurify","Comments","Single","post","setPost","post_likes","setPostLikes","location","navigate","postId","pathname","split","currentUser","report_status","set_report_status","fetchData","get","res","data","totalLikes","console","log","Like","post_array","Dis_Like","report_handler","message","deletepostid","usersname","username","handleDelete","array","getText","html","doc","DOMParser","parseFromString","body","textContent","writer_id","__html","sanitize","post_content","tag1","tag2","tag3","totalDislikes","reportCount"],"sources":["C:/Users/musta/Documents/GitHub/guest_posting/client/src/pages/Single.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport Edit from \"../img/edit.png\";\r\nimport Delete from \"../img/delete.png\";\r\nimport { Link, useLocation, useNavigate } from \"react-router-dom\";\r\nimport Menu from \"../components/Menu\";\r\nimport axios from \"axios\";\r\nimport moment from \"moment\";\r\nimport { useContext } from \"react\";\r\nimport { AuthContext } from \"../context/authContext\";\r\nimport DOMPurify from \"dompurify\";\r\nimport Comments from \"./comments\";\r\n\r\n\r\n\r\nconst Single = () => {\r\n  const [post, setPost] = useState({});\r\n  const [post_likes , setPostLikes] = useState(0)\r\n\r\n  const location = useLocation();\r\n  const navigate = useNavigate();\r\n\r\n  const postId = location.pathname.split(\"/\")[2];\r\n  // console.log(location.pathname.split(\"/\"))\r\n  const { currentUser } = useContext(AuthContext);\r\n  const [report_status , set_report_status] = useState(null);\r\n\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      try {\r\n        // console.log(\"YESS I M CALLEDDDDDDD\")\r\n        const res = await axios.get(`/posts/${postId}`);\r\n        // console.log(res.data)\r\n        // console.log(\"POST ID : \", postId)\r\n        // console.log(\"in fetch data\")\r\n        setPostLikes(res.data.totalLikes)\r\n        setPost(res.data);\r\n        // console.log(\"YOUR TOTAL LIKES : \",post_likes)\r\n      } catch (err) {\r\n        console.log(err);\r\n      }\r\n    };\r\n    fetchData();\r\n    // console.log(\"yess!!!!!!!!!!!!\")\r\n  }, [post]);\r\n\r\n\r\n\r\n\r\n// READER FUNCTIONALITY : \r\n\r\n\r\n\r\n\r\n  const Like = async(post) => \r\n  {\r\n    // console.log(post)\r\n    try {\r\n      // post.totalLikes = post.totalLikes + 1\r\n      const post_array = [post , currentUser]\r\n      const res = await axios.post(`/posts/update_like` , post_array);\r\n    } catch (err){\r\n      console.log(\"err : \" , err)\r\n    }\r\n    \r\n  }\r\n\r\n  const Dis_Like = async(post) => \r\n  {\r\n    // console.log(post)\r\n    try {\r\n      // post.totalDislikes = post.totalDislikes + 1\r\n      const post_array = [post , currentUser]\r\n      const res = await axios.post(`/posts/update_dislike` , post_array);\r\n    } catch (err){\r\n      console.log(\"err : \" , err)\r\n    }\r\n    \r\n  }\r\n\r\n  const report_handler = async(post) => {\r\n\r\n    try {\r\n      // post.totalLikes = post.totalLikes + 1\r\n      const post_array = [post , currentUser]\r\n      const res = await axios.post(`/posts/update_report_status` , post_array);\r\n      set_report_status(res.data.message)\r\n      console.log(post)\r\n    } catch (err){\r\n      \r\n      console.log(err)\r\n      // set_report_status(err.response.data)\r\n\r\n    }\r\n  }\r\n\r\n\r\n  const deletepostid= postId\r\n  const usersname= currentUser.username\r\n  const handleDelete = async (post)=>{\r\n    try {\r\n      const array= [deletepostid,usersname ]\r\n      console.log(\"This is the stuff deleting:\", array)\r\n      await axios.post(`/posts/${postId}`,array);\r\n      navigate(\"/\")\r\n    } catch (err) {\r\n      console.log(\"Throwing error\")\r\n      console.log(err);\r\n    }\r\n  }\r\n\r\n\r\n  const getText = (html) =>{\r\n    const doc = new DOMParser().parseFromString(html, \"text/html\")\r\n    return doc.body.textContent\r\n  }\r\n\r\n  return (\r\n    <div className=\"single\">\r\n      <div className=\"content\">\r\n        <div className=\"user\">\r\n          <div className=\"repo\">\r\n          </div>\r\n              <div className=\"userSingle\">\r\n                <span>{post.writer_id}</span>\r\n              </div>\r\n        </div>\r\n        \r\n        <p className=\"postContent\"\r\n          dangerouslySetInnerHTML={{\r\n            __html: DOMPurify.sanitize(post.post_content),\r\n          }}\r\n        ></p>\r\n        <h1 className=\"tagsSingle\">{post.tag1}   {post.tag2}   {post.tag3}</h1>\r\n          <div className=\"buttonsSingle\">\r\n          <button className = \"button\" onClick = {() => Like(post)}> 👍UpVote : {post.totalLikes}</button>\r\n          <button className = \"button\" onClick = {() => Dis_Like(post)}>👎DownVote : {post.totalDislikes}</button>\r\n          <button className = \"button\" onClick = {() => report_handler(post)}> 🚩Reports:{post.reportCount}<strong>{report_status}</strong> </button>\r\n          <button className = \"button\" onClick={() => handleDelete(post)}>Delete</button>\r\n          </div>\r\n          {Comments(postId)}\r\n        </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Single;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}