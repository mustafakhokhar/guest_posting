{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\musta\\\\Documents\\\\GitHub\\\\guest_posting\\\\client\\\\src\\\\pages\\\\Single.jsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from \"react\";\nimport Edit from \"../img/edit.png\";\nimport Delete from \"../img/delete.png\";\nimport { Link, useLocation, useNavigate } from \"react-router-dom\";\nimport Menu from \"../components/Menu\";\nimport axios from \"axios\";\nimport moment from \"moment\";\nimport { useContext } from \"react\";\nimport { AuthContext } from \"../context/authContext\";\nimport DOMPurify from \"dompurify\";\nimport Comments from \"./comments\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Single = () => {\n  _s();\n  const [post, setPost] = useState({});\n  const [post_likes, setPostLikes] = useState(0);\n  const location = useLocation();\n  const navigate = useNavigate();\n  const postId = location.pathname.split(\"/\")[2];\n  // console.log(location.pathname.split(\"/\"))\n  const {\n    currentUser\n  } = useContext(AuthContext);\n  const [report_status, set_report_status] = useState(null);\n  useEffect(() => {\n    const fetchData = async () => {\n      try {\n        // console.log(\"YESS I M CALLEDDDDDDD\")\n        const res = await axios.get(`/posts/${postId}`);\n        // console.log(res.data)\n        // console.log(\"POST ID : \", postId)\n        // console.log(\"in fetch data\")\n        setPostLikes(res.data.totalLikes);\n        setPost(res.data);\n        // console.log(\"YOUR TOTAL LIKES : \",post_likes)\n      } catch (err) {\n        console.log(err);\n      }\n    };\n    fetchData();\n    // console.log(\"yess!!!!!!!!!!!!\")\n  }, [post]);\n\n  // READER FUNCTIONALITY : \n\n  const Like = async post => {\n    // console.log(post)\n    try {\n      // post.totalLikes = post.totalLikes + 1\n      const post_array = [post, currentUser];\n      const res = await axios.post(`/posts/update_like`, post_array);\n    } catch (err) {\n      console.log(\"err : \", err);\n    }\n  };\n  const Dis_Like = async post => {\n    // console.log(post)\n    try {\n      // post.totalDislikes = post.totalDislikes + 1\n      const post_array = [post, currentUser];\n      const res = await axios.post(`/posts/update_dislike`, post_array);\n    } catch (err) {\n      console.log(\"err : \", err);\n    }\n  };\n  const report_handler = async post => {\n    try {\n      // post.totalLikes = post.totalLikes + 1\n      const post_array = [post, currentUser];\n      const res = await axios.post(`/posts/update_report_status`, post_array);\n      set_report_status(res.data.message);\n      console.log(post);\n    } catch (err) {\n      console.log(err);\n      // set_report_status(err.response.data)\n    }\n  };\n\n  const deletepostid = postId;\n  const usersname = currentUser.username;\n  const handleDelete = async post => {\n    try {\n      const array = [deletepostid, usersname];\n      console.log(\"This is the stuff deleting:\", array);\n      await axios.post(`/posts/${postId}`, array);\n      navigate(\"/\");\n    } catch (err) {\n      console.log(\"Throwing error\");\n      console.log(err);\n    }\n  };\n  const getText = html => {\n    const doc = new DOMParser().parseFromString(html, \"text/html\");\n    return doc.body.textContent;\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"single\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"content\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"user\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"repo\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"userSingle\",\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            children: post.writer_id\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 124,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"postContent\",\n        dangerouslySetInnerHTML: {\n          __html: DOMPurify.sanitize(post.post_content)\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n        className: \"tagsSingle\",\n        children: [post.tag1, \"   \", post.tag2, \"   \", post.tag3]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"buttonsSingle\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"button\",\n          onClick: () => Like(post),\n          children: [\" \\uD83D\\uDC4DUpVote : \", post.totalLikes]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 135,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"button\",\n          onClick: () => Dis_Like(post),\n          children: [\"\\uD83D\\uDC4EDownVote : \", post.totalDislikes]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 136,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"button\",\n          onClick: () => report_handler(post),\n          children: [\" \\uD83D\\uDEA9Reports:\", post.reportCount, /*#__PURE__*/_jsxDEV(\"strong\", {\n            children: report_status\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 137,\n            columnNumber: 108\n          }, this), \" \"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 137,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"button\",\n          onClick: () => handleDelete(post),\n          children: \"Delete\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 138,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 11\n      }, this), Comments(postId)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 118,\n    columnNumber: 5\n  }, this);\n};\n_s(Single, \"I9ybUJA4LVDzuV5T0h00cO8MUJY=\", false, function () {\n  return [useLocation, useNavigate];\n});\n_c = Single;\nexport default Single;\nvar _c;\n$RefreshReg$(_c, \"Single\");","map":{"version":3,"names":["React","useEffect","useState","Edit","Delete","Link","useLocation","useNavigate","Menu","axios","moment","useContext","AuthContext","DOMPurify","Comments","Single","post","setPost","post_likes","setPostLikes","location","navigate","postId","pathname","split","currentUser","report_status","set_report_status","fetchData","res","get","data","totalLikes","err","console","log","Like","post_array","Dis_Like","report_handler","message","deletepostid","usersname","username","handleDelete","array","getText","html","doc","DOMParser","parseFromString","body","textContent","writer_id","__html","sanitize","post_content","tag1","tag2","tag3","totalDislikes","reportCount"],"sources":["C:/Users/musta/Documents/GitHub/guest_posting/client/src/pages/Single.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport Edit from \"../img/edit.png\";\r\nimport Delete from \"../img/delete.png\";\r\nimport { Link, useLocation, useNavigate } from \"react-router-dom\";\r\nimport Menu from \"../components/Menu\";\r\nimport axios from \"axios\";\r\nimport moment from \"moment\";\r\nimport { useContext } from \"react\";\r\nimport { AuthContext } from \"../context/authContext\";\r\nimport DOMPurify from \"dompurify\";\r\nimport Comments from \"./comments\";\r\n\r\n\r\n\r\nconst Single = () => {\r\n  const [post, setPost] = useState({});\r\n  const [post_likes , setPostLikes] = useState(0)\r\n\r\n  const location = useLocation();\r\n  const navigate = useNavigate();\r\n\r\n  const postId = location.pathname.split(\"/\")[2];\r\n  // console.log(location.pathname.split(\"/\"))\r\n  const { currentUser } = useContext(AuthContext);\r\n  const [report_status , set_report_status] = useState(null);\r\n\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      try {\r\n        // console.log(\"YESS I M CALLEDDDDDDD\")\r\n        const res = await axios.get(`/posts/${postId}`);\r\n        // console.log(res.data)\r\n        // console.log(\"POST ID : \", postId)\r\n        // console.log(\"in fetch data\")\r\n        setPostLikes(res.data.totalLikes)\r\n        setPost(res.data);\r\n        // console.log(\"YOUR TOTAL LIKES : \",post_likes)\r\n      } catch (err) {\r\n        console.log(err);\r\n      }\r\n    };\r\n    fetchData();\r\n    // console.log(\"yess!!!!!!!!!!!!\")\r\n  }, [post]);\r\n\r\n\r\n\r\n\r\n// READER FUNCTIONALITY : \r\n\r\n\r\n\r\n\r\n  const Like = async(post) => \r\n  {\r\n    // console.log(post)\r\n    try {\r\n      // post.totalLikes = post.totalLikes + 1\r\n      const post_array = [post , currentUser]\r\n      const res = await axios.post(`/posts/update_like` , post_array);\r\n    } catch (err){\r\n      console.log(\"err : \" , err)\r\n    }\r\n    \r\n  }\r\n\r\n  const Dis_Like = async(post) => \r\n  {\r\n    // console.log(post)\r\n    try {\r\n      // post.totalDislikes = post.totalDislikes + 1\r\n      const post_array = [post , currentUser]\r\n      const res = await axios.post(`/posts/update_dislike` , post_array);\r\n    } catch (err){\r\n      console.log(\"err : \" , err)\r\n    }\r\n    \r\n  }\r\n\r\n  const report_handler = async(post) => {\r\n\r\n    try {\r\n      // post.totalLikes = post.totalLikes + 1\r\n      const post_array = [post , currentUser]\r\n      const res = await axios.post(`/posts/update_report_status` , post_array);\r\n      set_report_status(res.data.message)\r\n      console.log(post)\r\n    } catch (err){\r\n      \r\n      console.log(err)\r\n      // set_report_status(err.response.data)\r\n\r\n    }\r\n  }\r\n\r\n\r\n  const deletepostid= postId\r\n  const usersname= currentUser.username\r\n  const handleDelete = async (post)=>{\r\n    try {\r\n      const array= [deletepostid,usersname ]\r\n      console.log(\"This is the stuff deleting:\", array)\r\n      await axios.post(`/posts/${postId}`,array);\r\n      navigate(\"/\")\r\n    } catch (err) {\r\n      console.log(\"Throwing error\")\r\n      console.log(err);\r\n    }\r\n  }\r\n\r\n\r\n  const getText = (html) =>{\r\n    const doc = new DOMParser().parseFromString(html, \"text/html\")\r\n    return doc.body.textContent\r\n  }\r\n\r\n  return (\r\n    <div className=\"single\">\r\n      <div className=\"content\">\r\n        <div className=\"user\">\r\n          <div className=\"repo\">\r\n          </div>\r\n              <div className=\"userSingle\">\r\n                <span>{post.writer_id}</span>\r\n              </div>\r\n        </div>\r\n        \r\n        <p className=\"postContent\"\r\n          dangerouslySetInnerHTML={{\r\n            __html: DOMPurify.sanitize(post.post_content),\r\n          }}\r\n        ></p>\r\n        <h1 className=\"tagsSingle\">{post.tag1}   {post.tag2}   {post.tag3}</h1>\r\n          <div className=\"buttonsSingle\">\r\n          <button className = \"button\" onClick = {() => Like(post)}> 👍UpVote : {post.totalLikes}</button>\r\n          <button className = \"button\" onClick = {() => Dis_Like(post)}>👎DownVote : {post.totalDislikes}</button>\r\n          <button className = \"button\" onClick = {() => report_handler(post)}> 🚩Reports:{post.reportCount}<strong>{report_status}</strong> </button>\r\n          <button className = \"button\" onClick={() => handleDelete(post)}>Delete</button>\r\n          </div>\r\n          {Comments(postId)}\r\n        </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Single;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}